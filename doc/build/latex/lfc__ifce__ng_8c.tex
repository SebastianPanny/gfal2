\section{/home/adevress/myworkspace/gfal/src/common/lfc/lfc\_\-ifce\_\-ng.c File Reference}
\label{lfc__ifce__ng_8c}\index{/home/adevress/myworkspace/gfal/src/common/lfc/lfc_ifce_ng.c@{/home/adevress/myworkspace/gfal/src/common/lfc/lfc\_\-ifce\_\-ng.c}}
main internal file of the lfc plugin module 

{\tt \#include $<$errno.h$>$}\par
{\tt \#include $<$stdio.h$>$}\par
{\tt \#include $<$string.h$>$}\par
{\tt \#include $<$time.h$>$}\par
{\tt \#include $<$sys/types.h$>$}\par
{\tt \#include $<$dlfcn.h$>$}\par
{\tt \#include $<$stdlib.h$>$}\par
{\tt \#include $<$pthread.h$>$}\par
{\tt \#include $<$serrno.h$>$}\par
{\tt \#include $<$uuid/uuid.h$>$}\par
{\tt \#include $<$common/gfal\_\-prototypes.h$>$}\par
{\tt \#include $<$common/gfal\_\-types.h$>$}\par
{\tt \#include $<$common/gfal\_\-common\_\-plugin.h$>$}\par
{\tt \#include \char`\"{}../mds/gfal\_\-common\_\-mds.h\char`\"{}}\par
{\tt \#include \char`\"{}../gfal\_\-common\_\-interface.h\char`\"{}}\par
{\tt \#include \char`\"{}lfc\_\-ifce\_\-ng.h\char`\"{}}\par
{\tt \#include \char`\"{}../gfal\_\-common\_\-errverbose.h\char`\"{}}\par
\subsection*{Defines}
\begin{CompactItemize}
\item 
\#define \textbf{\_\-GNU\_\-SOURCE}\label{lfc__ifce__ng_8c_53abf256730d533302d1910e5fb61efe}

\item 
\#define \textbf{GFAL\_\-LFN\_\-MAX\_\-LEN}~2048\label{lfc__ifce__ng_8c_74cbac9029a516b4ae28199debf71835}

\end{CompactItemize}
\subsection*{Functions}
\begin{CompactItemize}
\item 
int \textbf{gfal\_\-lfc\_\-regex\_\-compile} (regex\_\-t $\ast$rex, GError $\ast$$\ast$err)\label{lfc__ifce__ng_8c_4ecadc4bf36b4b23af7beb949f6190be}

\item 
void \bf{gfal\_\-lfc\_\-init\_\-thread} (struct lfc\_\-ops $\ast$ops)
\item 
int \textbf{gfal\_\-lfc\_\-start\-Session} (struct lfc\_\-ops $\ast$ops, GError $\ast$$\ast$err)\label{lfc__ifce__ng_8c_191824f5c6bfee67e81f0c495e9bb778}

\item 
void \textbf{gfal\_\-auto\_\-maintain\_\-session} (struct lfc\_\-ops $\ast$ops, GError $\ast$$\ast$err)\label{lfc__ifce__ng_8c_9be7f93578b4772ec1498fe197f3c2c4}

\item 
void \textbf{lfc\_\-set\_\-session\_\-timeout} (int timeout)\label{lfc__ifce__ng_8c_656ee4eb29a1bcf4e9e1d9a4aafd4c82}

\item 
char $\ast$ \textbf{gfal\_\-get\_\-lfchost\_\-envar} (GError $\ast$$\ast$err)\label{lfc__ifce__ng_8c_9a5b8e8e30853b920e3bbe41062e1d25}

\item 
char $\ast$ \bf{gfal\_\-convert\_\-guid\_\-to\_\-lfn} (plugin\_\-handle handle, char $\ast$guid, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-convert\_\-guid\_\-to\_\-lfn\_\-r} (plugin\_\-handle handle, const char $\ast$guid, char $\ast$buff\_\-lfn, size\_\-t sbuff\_\-lfn, GError $\ast$$\ast$err)
\item 
char $\ast$ \bf{gfal\_\-setup\_\-lfchost} (gfal\_\-handle handle, GError $\ast$$\ast$err)
\item 
lfc\_\-ops $\ast$ \bf{gfal\_\-load\_\-lfc} (const char $\ast$name, GError $\ast$$\ast$err)
\item 
int \textbf{gfal\_\-lfc\_\-convert\_\-statg} (struct stat $\ast$output, struct lfc\_\-filestatg $\ast$input, GError $\ast$$\ast$err)\label{lfc__ifce__ng_8c_79cceda78f871c9bd8568a636dd31206}

\item 
int \textbf{gfal\_\-lfc\_\-convert\_\-lstat} (struct stat $\ast$output, struct lfc\_\-filestat $\ast$input, GError $\ast$$\ast$err)\label{lfc__ifce__ng_8c_16e8d4c4177c6e1d39c1850f06042f97}

\item 
int \bf{gfal\_\-lfc\_\-mkdir\_\-rec} (struct lfc\_\-ops $\ast$ops, char $\ast$browser\_\-path, const char $\ast$full\_\-path, mode\_\-t mode, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-lfc\_\-ifce\_\-mkdirp\-G} (struct lfc\_\-ops $\ast$ops, const char $\ast$path, mode\_\-t mode, gboolean pflag, GError $\ast$$\ast$err)
\item 
char $\ast$$\ast$ \bf{gfal\_\-lfc\_\-get\-SURL} (struct lfc\_\-ops $\ast$ops, const char $\ast$path, GError $\ast$$\ast$err)
\item 
int \textbf{gfal\_\-lfc\_\-get\-Comment} (struct lfc\_\-ops $\ast$ops, const char $\ast$lfn, char $\ast$buff, size\_\-t s\_\-buff, GError $\ast$$\ast$err)\label{lfc__ifce__ng_8c_71ac937c7262a53247ea1b204ae23c6c}

\item 
int \textbf{gfal\_\-lfc\_\-set\-Comment} (struct lfc\_\-ops $\ast$ops, const char $\ast$lfn, const char $\ast$buff, size\_\-t s\_\-buff, GError $\ast$$\ast$err)\label{lfc__ifce__ng_8c_0b9952562acf59969aefc9519956f877}

\item 
int \textbf{gfal\_\-lfc\_\-get\-Checksum} (struct lfc\_\-ops $\ast$ops, const char $\ast$lfn, lfc\_\-checksum $\ast$checksum, GError $\ast$$\ast$err)\label{lfc__ifce__ng_8c_3285a6a2cf6d76aa8fadabaee79f7896}

\item 
int \textbf{gfal\_\-lfc\_\-statg} (struct lfc\_\-ops $\ast$ops, const char $\ast$lfn, struct lfc\_\-filestatg $\ast$statbuf, GError $\ast$$\ast$err)\label{lfc__ifce__ng_8c_220714510c3f197e656ddea9f04ffec3}

\item 
ssize\_\-t \textbf{g\_\-strv\_\-catbuff} (char $\ast$$\ast$strv, char $\ast$buff, size\_\-t size)\label{lfc__ifce__ng_8c_bc04cd8d7342170700f02f6297fc4105}

\item 
int \textbf{gfal\_\-lfc\_\-get\_\-errno} (struct lfc\_\-ops $\ast$ops)\label{lfc__ifce__ng_8c_caa53981228e722b2175cfd7b4ca051c}

\item 
char $\ast$ \textbf{gfal\_\-lfc\_\-get\_\-strerror} (struct lfc\_\-ops $\ast$ops)\label{lfc__ifce__ng_8c_58172b62403dfd7a7b742548f074cd44}

\item 
void \bf{gfal\_\-generate\_\-guid\-G} (char $\ast$buf, GError $\ast$$\ast$err)
\begin{CompactList}\small\item\em generate an uiid string Generate a uuid string and cpy it in the buf, \item\end{CompactList}\item 
int \textbf{gfal\_\-lfc\_\-set\_\-host} (const char $\ast$host, GError $\ast$$\ast$err)\label{lfc__ifce__ng_8c_8d1fdb84029a45d15dcd460c648f0fbc}

\end{CompactItemize}


\subsection{Detailed Description}
main internal file of the lfc plugin module 

\begin{Desc}
\item[Author:]Adrien Devresse \end{Desc}
\begin{Desc}
\item[Version:]0.0.1 \end{Desc}
\begin{Desc}
\item[Date:]02/05/2011 \end{Desc}


\subsection{Function Documentation}
\index{lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}!gfal_convert_guid_to_lfn@{gfal\_\-convert\_\-guid\_\-to\_\-lfn}}
\index{gfal_convert_guid_to_lfn@{gfal\_\-convert\_\-guid\_\-to\_\-lfn}!lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ gfal\_\-convert\_\-guid\_\-to\_\-lfn (plugin\_\-handle {\em handle}, char $\ast$ {\em guid}, GError $\ast$$\ast$ {\em err})}\label{lfc__ifce__ng_8c_4bfe1a660a34d4e1e8a5d220ee256ff5}


convert a guid to a lfn link with a call to the lfclib \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em handle}]handle of the lfc plugin \item[{\em string}]of the guid \item[{\em err}]: Error report system \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]: string of the lfn if success or NULL char$\ast$ if error \end{Desc}
\index{lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}!gfal_convert_guid_to_lfn_r@{gfal\_\-convert\_\-guid\_\-to\_\-lfn\_\-r}}
\index{gfal_convert_guid_to_lfn_r@{gfal\_\-convert\_\-guid\_\-to\_\-lfn\_\-r}!lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-convert\_\-guid\_\-to\_\-lfn\_\-r (plugin\_\-handle {\em handle}, const char $\ast$ {\em guid}, char $\ast$ {\em buff\_\-lfn}, size\_\-t {\em sbuff\_\-lfn}, GError $\ast$$\ast$ {\em err})}\label{lfc__ifce__ng_8c_70f8470c60821b33776b4504d6bb4610}


convert a guid to a lfn link with a call to the lfclib in a reantrant( buffer mode ) \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em handle}]plugin handle \item[{\em guid}]string of the guid \item[{\em buff\_\-lfn}]buffer for the lfn result \item[{\em sbuff\_\-lfn}]size of the buffer \item[{\em err}]: Error report system \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]: 0 else -1 if error and err is set \end{Desc}
\index{lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}!gfal_generate_guidG@{gfal\_\-generate\_\-guidG}}
\index{gfal_generate_guidG@{gfal\_\-generate\_\-guidG}!lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void gfal\_\-generate\_\-guid\-G (char $\ast$ {\em buf}, GError $\ast$$\ast$ {\em err})}\label{lfc__ifce__ng_8c_4cb5e50a1af5612463aaa525162a2e9e}


generate an uiid string Generate a uuid string and cpy it in the buf, 

\begin{Desc}
\item[Warning:]buff must be $>$ uuid size ( 37 bytes ) \end{Desc}
\index{lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}!gfal_lfc_getSURL@{gfal\_\-lfc\_\-getSURL}}
\index{gfal_lfc_getSURL@{gfal\_\-lfc\_\-getSURL}!lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}char$\ast$$\ast$ gfal\_\-lfc\_\-get\-SURL (struct lfc\_\-ops $\ast$ {\em ops}, const char $\ast$ {\em path}, GError $\ast$$\ast$ {\em err})}\label{lfc__ifce__ng_8c_26c355c9cf576886a743ab1917de295d}


return a list of surls from a getreplica request \index{lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}!gfal_lfc_ifce_mkdirpG@{gfal\_\-lfc\_\-ifce\_\-mkdirpG}}
\index{gfal_lfc_ifce_mkdirpG@{gfal\_\-lfc\_\-ifce\_\-mkdirpG}!lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-lfc\_\-ifce\_\-mkdirp\-G (struct lfc\_\-ops $\ast$ {\em ops}, const char $\ast$ {\em path}, mode\_\-t {\em mode}, gboolean {\em pflag}, GError $\ast$$\ast$ {\em err})}\label{lfc__ifce__ng_8c_9fa43925882e2e196e0020b529827d3c}


Implementation of mkdir -p call on the lfc \index{lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}!gfal_lfc_init_thread@{gfal\_\-lfc\_\-init\_\-thread}}
\index{gfal_lfc_init_thread@{gfal\_\-lfc\_\-init\_\-thread}!lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}void gfal\_\-lfc\_\-init\_\-thread (struct lfc\_\-ops $\ast$ {\em ops})}\label{lfc__ifce__ng_8c_aed5d8ab4c88e918990444e53930bfa4}


Routine for internal lfc hack, need to be call for the thread safety \index{lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}!gfal_lfc_mkdir_rec@{gfal\_\-lfc\_\-mkdir\_\-rec}}
\index{gfal_lfc_mkdir_rec@{gfal\_\-lfc\_\-mkdir\_\-rec}!lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-lfc\_\-mkdir\_\-rec (struct lfc\_\-ops $\ast$ {\em ops}, char $\ast$ {\em browser\_\-path}, const char $\ast$ {\em full\_\-path}, mode\_\-t {\em mode}, GError $\ast$$\ast$ {\em err})}\label{lfc__ifce__ng_8c_0d7c361d951ac79fee504d5125485033}


Begin a recursive call on mkdir to create a full tree path \begin{Desc}
\item[Warning:]not safe, please ensure that string begin by \char`\"{}/\char`\"{} \end{Desc}
\index{lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}!gfal_load_lfc@{gfal\_\-load\_\-lfc}}
\index{gfal_load_lfc@{gfal\_\-load\_\-lfc}!lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}struct lfc\_\-ops$\ast$ gfal\_\-load\_\-lfc (const char $\ast$ {\em name}, GError $\ast$$\ast$ {\em err})}\label{lfc__ifce__ng_8c_7c91643749a2c5d7e8043c0e42d00fd6}


load the shared library and link the symbol for the LFC usage \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em name}]: name of the library \item[{\em err,:}]error report \end{description}
\end{Desc}
\index{lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}!gfal_setup_lfchost@{gfal\_\-setup\_\-lfchost}}
\index{gfal_setup_lfchost@{gfal\_\-setup\_\-lfchost}!lfc_ifce_ng.c@{lfc\_\-ifce\_\-ng.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ gfal\_\-setup\_\-lfchost (gfal\_\-handle {\em handle}, GError $\ast$$\ast$ {\em err})}\label{lfc__ifce__ng_8c_5d13dc09e91f66d74de768c2e4bf4872}


setup the lfc\_\-host correctly for the lfc calls \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em err}]GError report system if \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]string of the endpoint, need to be free or NULL if error \end{Desc}
