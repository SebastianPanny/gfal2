\section{/home/adevress/myworkspace/gfal/src/common/gfal\_\-common\_\-plugin.c File Reference}
\label{gfal__common__plugin_8c}\index{/home/adevress/myworkspace/gfal/src/common/gfal_common_plugin.c@{/home/adevress/myworkspace/gfal/src/common/gfal\_\-common\_\-plugin.c}}
the file of the common lib for the plugin management 

{\tt \#include $<$stdio.h$>$}\par
{\tt \#include $<$stdlib.h$>$}\par
{\tt \#include $<$string.h$>$}\par
{\tt \#include $<$dlfcn.h$>$}\par
{\tt \#include $<$unistd.h$>$}\par
{\tt \#include $<$sys/types.h$>$}\par
{\tt \#include $<$fcntl.h$>$}\par
{\tt \#include \char`\"{}gfal\_\-types.h\char`\"{}}\par
{\tt \#include \char`\"{}gfal\_\-common\_\-plugin.h\char`\"{}}\par
{\tt \#include \char`\"{}gfal\_\-constants.h\char`\"{}}\par
{\tt \#include \char`\"{}gfal\_\-common\_\-errverbose.h\char`\"{}}\par
{\tt \#include \char`\"{}gfal\_\-common\_\-filedescriptor.h\char`\"{}}\par
\subsection*{Functions}
\begin{CompactItemize}
\item 
char $\ast$$\ast$ \textbf{gfal\_\-plugins\_\-get\_\-list} (gfal\_\-handle handle, GError $\ast$$\ast$err)\label{gfal__common__plugin_8c_59f53151c28e45f965a554a2a6806ad6}

\item 
int \bf{gfal\_\-plugins\_\-instance} (gfal\_\-handle handle, GError $\ast$$\ast$err)
\item 
int \textbf{gfal\_\-plugins\_\-operation\_\-executor} (gfal\_\-handle handle, gboolean($\ast$checker)(\bf{gfal\_\-plugin\_\-interface} $\ast$, GError $\ast$$\ast$), int($\ast$executor)(\bf{gfal\_\-plugin\_\-interface} $\ast$, GError $\ast$$\ast$), GError $\ast$$\ast$err)\label{gfal__common__plugin_8c_03cfec9717f9977a6e738574eb1f9ba4}

\item 
int \bf{gfal\_\-plugins\_\-access\-G} (gfal\_\-handle handle, const char $\ast$path, int mode, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-plugin\_\-stat\-G} (gfal\_\-handle handle, const char $\ast$path, struct stat $\ast$st, GError $\ast$$\ast$err)
\item 
ssize\_\-t \bf{gfal\_\-plugin\_\-readlink\-G} (gfal\_\-handle handle, const char $\ast$path, char $\ast$buff, size\_\-t buffsiz, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-plugin\_\-lstat\-G} (gfal\_\-handle handle, const char $\ast$path, struct stat $\ast$st, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-plugins\_\-delete} (gfal\_\-handle handle, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-plugin\_\-chmod\-G} (gfal\_\-handle handle, const char $\ast$path, mode\_\-t mode, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-plugin\_\-rename\-G} (gfal\_\-handle handle, const char $\ast$oldpath, const char $\ast$newpath, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-plugin\_\-symlink\-G} (gfal\_\-handle handle, const char $\ast$oldpath, const char $\ast$newpath, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-plugin\_\-mkdirp} (gfal\_\-handle handle, const char $\ast$path, mode\_\-t mode, gboolean pflag, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-plugin\_\-rmdir\-G} (gfal\_\-handle handle, const char $\ast$path, GError $\ast$$\ast$err)
\item 
gfal\_\-file\_\-handle \bf{gfal\_\-plugin\_\-opendir\-G} (gfal\_\-handle handle, const char $\ast$name, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-plugin\_\-closedir\-G} (gfal\_\-handle handle, gfal\_\-file\_\-handle fh, GError $\ast$$\ast$err)
\item 
gfal\_\-file\_\-handle \bf{gfal\_\-plugin\_\-open\-G} (gfal\_\-handle handle, const char $\ast$path, int flag, mode\_\-t mode, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-plugin\_\-close\-G} (gfal\_\-handle handle, gfal\_\-file\_\-handle fh, GError $\ast$$\ast$err)
\item 
dirent $\ast$ \bf{gfal\_\-plugin\_\-readdir\-G} (gfal\_\-handle handle, gfal\_\-file\_\-handle fh, GError $\ast$$\ast$err)
\item 
ssize\_\-t \bf{gfal\_\-plugin\_\-getxattr\-G} (gfal\_\-handle handle, const char $\ast$path, const char $\ast$name, void $\ast$buff, size\_\-t s\_\-buff, GError $\ast$$\ast$err)\label{gfal__common__plugin_8c_de1aadc6ff10f7fef83cb57a21ef1406}

\begin{CompactList}\small\item\em implementation in the plugin of the get extended attribute function \item\end{CompactList}\item 
ssize\_\-t \textbf{gfal\_\-plugin\_\-listxattr\-G} (gfal\_\-handle handle, const char $\ast$path, char $\ast$list, size\_\-t s\_\-list, GError $\ast$$\ast$err)\label{gfal__common__plugin_8c_ef696550c6ac4bab6dec58d7c857b3f4}

\item 
int \bf{gfal\_\-plugin\_\-read\-G} (gfal\_\-handle handle, gfal\_\-file\_\-handle fh, void $\ast$buff, size\_\-t s\_\-buff, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-plugin\_\-lseek\-G} (gfal\_\-handle handle, gfal\_\-file\_\-handle fh, off\_\-t offset, int whence, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-plugin\_\-write\-G} (gfal\_\-handle handle, gfal\_\-file\_\-handle fh, void $\ast$buff, size\_\-t s\_\-buff, GError $\ast$$\ast$err)
\item 
char $\ast$ \textbf{gfal\_\-get\_\-cat\_\-type} (GError $\ast$$\ast$err)\label{gfal__common__plugin_8c_c20aa1a376c802d0c60208854537851e}

\item 
int \textbf{gfal\_\-plugin\_\-unlink\-G} (plugin\_\-handle handle, const char $\ast$path, GError $\ast$$\ast$err)\label{gfal__common__plugin_8c_23ee550b9dd10a5561e6c9c233fb621f}

\end{CompactItemize}


\subsection{Detailed Description}
the file of the common lib for the plugin management 

\begin{Desc}
\item[Author:]Devresse Adrien \end{Desc}
\begin{Desc}
\item[Date:]8/04/2011 \end{Desc}


\subsection{Function Documentation}
\index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_chmodG@{gfal\_\-plugin\_\-chmodG}}
\index{gfal_plugin_chmodG@{gfal\_\-plugin\_\-chmodG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugin\_\-chmod\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, mode\_\-t {\em mode}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_f9780b8c4a097a65b42aee466a9218e0}


Execute the chmod function on the first compatible plugin ( checked with check\_\-url func ) \begin{Desc}
\item[Returns:]0 if success or -1 and set the GError to the correct errno value with a description msg \end{Desc}
\index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_closedirG@{gfal\_\-plugin\_\-closedirG}}
\index{gfal_plugin_closedirG@{gfal\_\-plugin\_\-closedirG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugin\_\-closedir\-G (gfal\_\-handle {\em handle}, gfal\_\-file\_\-handle {\em fh}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_980a66f9ea2946189c0d70f13471900f}


close the given dir handle in the proper plugin \index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_closeG@{gfal\_\-plugin\_\-closeG}}
\index{gfal_plugin_closeG@{gfal\_\-plugin\_\-closeG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugin\_\-close\-G (gfal\_\-handle {\em handle}, gfal\_\-file\_\-handle {\em fh}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_13d1db9798e5a830c745e2f909a484f4}


close the given file handle in the proper plugin \index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_lseekG@{gfal\_\-plugin\_\-lseekG}}
\index{gfal_plugin_lseekG@{gfal\_\-plugin\_\-lseekG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugin\_\-lseek\-G (gfal\_\-handle {\em handle}, gfal\_\-file\_\-handle {\em fh}, off\_\-t {\em offset}, int {\em whence}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_c29b06ae43aa86049b513d1174393019}


do a lseek operation on the plugin \begin{Desc}
\item[Returns:]return number of bytes readed else -1 if errors and GError is set \end{Desc}
\index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_lstatG@{gfal\_\-plugin\_\-lstatG}}
\index{gfal_plugin_lstatG@{gfal\_\-plugin\_\-lstatG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugin\_\-lstat\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, struct stat $\ast$ {\em st}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_81a0d301234958fc59518fb6ce306425}


Execute a lstat function in the lfc \index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_mkdirp@{gfal\_\-plugin\_\-mkdirp}}
\index{gfal_plugin_mkdirp@{gfal\_\-plugin\_\-mkdirp}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugin\_\-mkdirp (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, mode\_\-t {\em mode}, gboolean {\em pflag}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_815a97902a1067b99f9bcc2f63b19e11}


Execute a mkdir function on the first compatible plugin ( checked with check url func ) \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em handle}]handle of the current context \item[{\em path}]path to create \item[{\em mode}]right of the file created \item[{\em pflag}]if TRUE, execute the request recursively if necessary else work as the common mkdir system call \item[{\em GError}]error report system \end{description}
\end{Desc}
\begin{Desc}
\item[Warning:]no check on the path, please check the path before \end{Desc}
\begin{Desc}
\item[Returns:]return 0 if success else return -1 \end{Desc}
\index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_opendirG@{gfal\_\-plugin\_\-opendirG}}
\index{gfal_plugin_opendirG@{gfal\_\-plugin\_\-opendirG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}gfal\_\-file\_\-handle gfal\_\-plugin\_\-opendir\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em name}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_0f8363d00d0f3418edaef414a84df034}


Execute a opendir function on the first compatible plugin ( checked with check url func ) \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em handle}]handle of the current context \item[{\em path}]path to open \item[{\em GError}]error report system \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]gfal\_\-file\_\-handle pointer given to the handle or NULL if error \end{Desc}
\index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_openG@{gfal\_\-plugin\_\-openG}}
\index{gfal_plugin_openG@{gfal\_\-plugin\_\-openG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}gfal\_\-file\_\-handle gfal\_\-plugin\_\-open\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, int {\em flag}, mode\_\-t {\em mode}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_322dfbe0ad1e144573719ed08151281e}


open the file specified by path on the proper plugin with the specified flag and mode \index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_readdirG@{gfal\_\-plugin\_\-readdirG}}
\index{gfal_plugin_readdirG@{gfal\_\-plugin\_\-readdirG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}struct dirent$\ast$ gfal\_\-plugin\_\-readdir\-G (gfal\_\-handle {\em handle}, gfal\_\-file\_\-handle {\em fh}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_7fd9e55c89de0f0a85127972cecffcfd}


execute a readdir for the given file handle on the appropriate plugin \index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_readG@{gfal\_\-plugin\_\-readG}}
\index{gfal_plugin_readG@{gfal\_\-plugin\_\-readG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugin\_\-read\-G (gfal\_\-handle {\em handle}, gfal\_\-file\_\-handle {\em fh}, void $\ast$ {\em buff}, size\_\-t {\em s\_\-buff}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_d536879bc7813a35bc79318ce43f0b57}


do a read operation on the plugin, read s\_\-buff chars on the fd device \begin{Desc}
\item[Returns:]return number of bytes readed else -1 if errors and GError is set \end{Desc}
\index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_readlinkG@{gfal\_\-plugin\_\-readlinkG}}
\index{gfal_plugin_readlinkG@{gfal\_\-plugin\_\-readlinkG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}ssize\_\-t gfal\_\-plugin\_\-readlink\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, char $\ast$ {\em buff}, size\_\-t {\em buffsiz}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_d2e6e573b52926185793ff4f0dd5e307}


Execute a readlink function \index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_renameG@{gfal\_\-plugin\_\-renameG}}
\index{gfal_plugin_renameG@{gfal\_\-plugin\_\-renameG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugin\_\-rename\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em oldpath}, const char $\ast$ {\em newpath}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_ee26850796f50439ded98dafc7cd064b}


Execute the rename function on the first compatible plugin ( checked with check\_\-url func ) \begin{Desc}
\item[Returns:]0 if success or -1 and set the GError to the correct errno value with a description msg \end{Desc}
\index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_rmdirG@{gfal\_\-plugin\_\-rmdirG}}
\index{gfal_plugin_rmdirG@{gfal\_\-plugin\_\-rmdirG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugin\_\-rmdir\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_d3bcfafdf8d90935cb312388cdd6bb92}


Execute a rmdir function on the first compatible plugin ( checked with check url func ) \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em handle}]handle of the current context \item[{\em path}]path to delete \item[{\em GError}]error report system \end{description}
\end{Desc}
\begin{Desc}
\item[Warning:]no check on the path, please check the path before \end{Desc}
\begin{Desc}
\item[Returns:]return 0 if success else return -1 \end{Desc}
\index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_statG@{gfal\_\-plugin\_\-statG}}
\index{gfal_plugin_statG@{gfal\_\-plugin\_\-statG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugin\_\-stat\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, struct stat $\ast$ {\em st}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_98b9e43ecd18ce2fc728d4a731e52ce1}


Execute a stat function on the lfc plugin \index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_symlinkG@{gfal\_\-plugin\_\-symlinkG}}
\index{gfal_plugin_symlinkG@{gfal\_\-plugin\_\-symlinkG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugin\_\-symlink\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em oldpath}, const char $\ast$ {\em newpath}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_6ff9d39b564be7d0a560a09288e19b9e}


Execute the symlink function on the first compatible plugin \index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugin_writeG@{gfal\_\-plugin\_\-writeG}}
\index{gfal_plugin_writeG@{gfal\_\-plugin\_\-writeG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugin\_\-write\-G (gfal\_\-handle {\em handle}, gfal\_\-file\_\-handle {\em fh}, void $\ast$ {\em buff}, size\_\-t {\em s\_\-buff}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_caaf6298a84f453bb6ddd50c36b6dfd7}


do a write operation on the plugin, write s\_\-buff chars on the fd device \begin{Desc}
\item[Returns:]return number of bytes readed else -1 if errors and GError is set \end{Desc}
\index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugins_accessG@{gfal\_\-plugins\_\-accessG}}
\index{gfal_plugins_accessG@{gfal\_\-plugins\_\-accessG}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugins\_\-access\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, int {\em mode}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_b59f407ec7865163a60faaa56cbae432}


Execute an access function on the first plugin compatible in the plugin list return the result of the first valid plugin for a given URL \begin{Desc}
\item[Returns:]result of the access method or -1 if error and set GError with the correct value error : EPROTONOSUPPORT means that the URL is not matched by a plugin \end{Desc}
\index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugins_delete@{gfal\_\-plugins\_\-delete}}
\index{gfal_plugins_delete@{gfal\_\-plugins\_\-delete}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugins\_\-delete (gfal\_\-handle {\em handle}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__plugin_8c_3a5fd910584fad43a1a67c0e844ce528}


Delete all instance of plugins \index{gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}!gfal_plugins_instance@{gfal\_\-plugins\_\-instance}}
\index{gfal_plugins_instance@{gfal\_\-plugins\_\-instance}!gfal_common_plugin.c@{gfal\_\-common\_\-plugin.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-plugins\_\-instance (gfal\_\-handle {\em handle}, GError $\ast$$\ast$ {\em err})\hspace{0.3cm}{\tt  [inline]}}\label{gfal__common__plugin_8c_4d38083d4b9f51095013c0f3d233c0da}


Instance all plugins for use if it's not the case return the number of plugin available 