\section{/home/adevress/myworkspace/gfal/src/common/gfal\_\-common\_\-catalog.h File Reference}
\label{gfal__common__catalog_8h}\index{/home/adevress/myworkspace/gfal/src/common/gfal_common_catalog.h@{/home/adevress/myworkspace/gfal/src/common/gfal\_\-common\_\-catalog.h}}
the header file of the common lib for the catalog management 

{\tt \#include $<$stdarg.h$>$}\par
{\tt \#include $<$uuid/uuid.h$>$}\par
{\tt \#include $<$glib.h$>$}\par
{\tt \#include $<$errno.h$>$}\par
{\tt \#include $<$string.h$>$}\par
{\tt \#include $<$dirent.h$>$}\par
{\tt \#include $<$sys/stat.h$>$}\par
{\tt \#include \char`\"{}gfal\_\-prototypes.h\char`\"{}}\par
{\tt \#include \char`\"{}gfal\_\-types.h\char`\"{}}\par
\subsection*{Data Structures}
\begin{CompactItemize}
\item 
struct \textbf{\_\-gfal\_\-catalog\_\-interface}
\item 
struct \bf{\_\-catalog\_\-opts}
\end{CompactItemize}
\subsection*{Defines}
\begin{CompactItemize}
\item 
\#define \textbf{MAX\_\-CATALOG\_\-LIST}~64\label{gfal__common__catalog_8h_c39f705683e893b91f559704ee2a707e}

\end{CompactItemize}
\subsection*{Enumerations}
\begin{CompactItemize}
\item 
enum \textbf{\_\-catalog\_\-mode} \{ \par
\textbf{GFAL\_\-CATALOG\_\-ALL} = 0, 
\textbf{GFAL\_\-CATALOG\_\-ACCESS}, 
\textbf{GFAL\_\-CATALOG\_\-CHMOD}, 
\textbf{GFAL\_\-CATALOG\_\-RENAME}, 
\par
\textbf{GFAL\_\-CATALOG\_\-STAT}, 
\textbf{GFAL\_\-CATALOG\_\-LSTAT}, 
\textbf{GFAL\_\-CATALOG\_\-MKDIR}, 
\textbf{GFAL\_\-CATALOG\_\-RMDIR}, 
\par
\textbf{GFAL\_\-CATALOG\_\-OPENDIR}, 
\textbf{GFAL\_\-CATALOG\_\-OPEN}, 
\textbf{GFAL\_\-CATALOG\_\-GETSURL}
 \}
\end{CompactItemize}
\subsection*{Functions}
\begin{CompactItemize}
\item 
char $\ast$ \bf{gfal\_\-get\_\-cat\_\-type} (GError $\ast$$\ast$)
\begin{CompactList}\small\item\em catalog type getter \item\end{CompactList}\item 
int \bf{gfal\_\-catalogs\_\-instance} (gfal\_\-handle, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-catalogs\_\-access\-G} (gfal\_\-handle handle, const char $\ast$path, int mode, GError $\ast$$\ast$err)
\item 
int \textbf{gfal\_\-catalogs\_\-guid\_\-access\-G} (gfal\_\-handle handle, char $\ast$guid, int mode, GError $\ast$$\ast$err)\label{gfal__common__catalog_8h_fdd144370f8c6df2564eaddbf26e2fd5}

\item 
int \bf{gfal\_\-catalogs\_\-delete} (gfal\_\-handle, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-catalog\_\-stat\-G} (gfal\_\-handle handle, const char $\ast$path, struct stat $\ast$st, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-catalog\_\-lstat\-G} (gfal\_\-handle handle, const char $\ast$path, struct stat $\ast$st, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-catalog\_\-mkdirp} (gfal\_\-handle handle, const char $\ast$path, mode\_\-t mode, gboolean pflag, GError $\ast$$\ast$err)
\item 
char $\ast$ \textbf{gfal\_\-catalog\_\-resolve\_\-guid} (gfal\_\-handle handle, const char $\ast$guid, GError $\ast$$\ast$err)\label{gfal__common__catalog_8h_4955825d7c275f3dfae9a57232642370}

\item 
gfal\_\-file\_\-handle \bf{gfal\_\-catalog\_\-opendir\-G} (gfal\_\-handle handle, const char $\ast$name, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-catalog\_\-closedir\-G} (gfal\_\-handle handle, gfal\_\-file\_\-handle fh, GError $\ast$$\ast$err)
\item 
gfal\_\-file\_\-handle \bf{gfal\_\-catalog\_\-open\-G} (gfal\_\-handle handle, const char $\ast$path, int flag, mode\_\-t mode, GError $\ast$$\ast$err)
\item 
int \bf{gfal\_\-catalog\_\-close\-G} (gfal\_\-handle handle, gfal\_\-file\_\-handle fh, GError $\ast$$\ast$err)
\item 
char $\ast$$\ast$ \bf{gfal\_\-catalog\_\-get\-SURL} (gfal\_\-handle handle, const char $\ast$path, GError $\ast$$\ast$err)
\item 
dirent $\ast$ \bf{gfal\_\-catalog\_\-readdir\-G} (gfal\_\-handle handle, gfal\_\-file\_\-handle fh, GError $\ast$$\ast$err)
\item 
char $\ast$ \textbf{get\_\-default\_\-se} (char $\ast$, int)\label{gfal__common__catalog_8h_c304a754c49bedeec6c1c9b1445b937d}

\item 
int \textbf{purify\_\-surl} (const char $\ast$, char $\ast$, const int)\label{gfal__common__catalog_8h_c25d6ed82e636c14d640318a2ad5f3b5}

\item 
int \textbf{setypesandendpointsfromsurl} (const char $\ast$, char $\ast$$\ast$$\ast$, char $\ast$$\ast$$\ast$, char $\ast$, int)\label{gfal__common__catalog_8h_f398c539d03eaea6dcb6b45067cb21f2}

\item 
int \textbf{setypesandendpoints} (const char $\ast$, char $\ast$$\ast$$\ast$, char $\ast$$\ast$$\ast$, char $\ast$, int)\label{gfal__common__catalog_8h_f06de10d100ffd8ad880619661708810}

\item 
int \textbf{canonical\_\-url} (const char $\ast$, const char $\ast$, char $\ast$, int, char $\ast$, int)\label{gfal__common__catalog_8h_845c890f2d493921bd587158fab72d65}

\item 
int \textbf{parseturl} (const char $\ast$, char $\ast$, int, char $\ast$, int, char $\ast$, int)\label{gfal__common__catalog_8h_70868bce152313f31e24982453f10723}

\item 
int \textbf{replica\_\-exists} (const char $\ast$, char $\ast$, int)\label{gfal__common__catalog_8h_ac34379d44fb4037af134b34a9aae030}

\item 
int \textbf{getdomainnm} (char $\ast$name, int namelen)\label{gfal__common__catalog_8h_446a829e4f333d3a0364ab0f2b5a2dc7}

\item 
char $\ast$$\ast$ \textbf{get\_\-sup\_\-proto} ()\label{gfal__common__catalog_8h_03347619db3b30ef54ae6a98e351e21f}

\item 
proto\_\-ops $\ast$ \textbf{find\_\-pops} (const char $\ast$)\label{gfal__common__catalog_8h_40d4c392e45e16062bc90caf0ebfa436}

\item 
int \textbf{mapposixerror} (struct proto\_\-ops $\ast$, int)\label{gfal__common__catalog_8h_c8360922877ec368815d412209e862a2}

\end{CompactItemize}


\subsection{Detailed Description}
the header file of the common lib for the catalog management 

\begin{Desc}
\item[Author:]Devresse Adrien \end{Desc}
\begin{Desc}
\item[Version:]0.0.1 \end{Desc}
\begin{Desc}
\item[Date:]8/04/2011 \end{Desc}


\subsection{Function Documentation}
\index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_catalog_closedirG@{gfal\_\-catalog\_\-closedirG}}
\index{gfal_catalog_closedirG@{gfal\_\-catalog\_\-closedirG}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-catalog\_\-closedir\-G (gfal\_\-handle {\em handle}, gfal\_\-file\_\-handle {\em fh}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__catalog_8h_348fe15690faed2e2731d15eb6cc7856}


close the given dir handle in the proper catalog \index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_catalog_closeG@{gfal\_\-catalog\_\-closeG}}
\index{gfal_catalog_closeG@{gfal\_\-catalog\_\-closeG}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-catalog\_\-close\-G (gfal\_\-handle {\em handle}, gfal\_\-file\_\-handle {\em fh}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__catalog_8h_27712f4ef0fd4a8d3d5b63b90936d295}


close the given file handle in the proper catalog \index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_catalog_getSURL@{gfal\_\-catalog\_\-getSURL}}
\index{gfal_catalog_getSURL@{gfal\_\-catalog\_\-getSURL}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}char$\ast$$\ast$ gfal\_\-catalog\_\-get\-SURL (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__catalog_8h_eeef83dd1c788197ed7ae4a933d8e8d3}


Resolve a link on the catalog to a list of surl \begin{Desc}
\item[Returns:]pointer to a table of string with all the surls, table end with NULL, or return NULL if error \end{Desc}
\begin{Desc}
\item[Warning:]must be free with g\_\-list\_\-free\_\-full \end{Desc}
\index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_catalog_lstatG@{gfal\_\-catalog\_\-lstatG}}
\index{gfal_catalog_lstatG@{gfal\_\-catalog\_\-lstatG}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-catalog\_\-lstat\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, struct stat $\ast$ {\em st}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__catalog_8h_1ad1b1f96272dbf43a15e7ea5d35389d}


Execute a lstat function in the lfc \index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_catalog_mkdirp@{gfal\_\-catalog\_\-mkdirp}}
\index{gfal_catalog_mkdirp@{gfal\_\-catalog\_\-mkdirp}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-catalog\_\-mkdirp (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, mode\_\-t {\em mode}, gboolean {\em pflag}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__catalog_8h_93da9b37bece0b034d80c17131761110}


Execute a mkdir function on the first compatible catalog ( checked with check url func ) \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em handle}]handle of the current context \item[{\em path}]path to create \item[{\em mode}]right of the file created \item[{\em pflag}]if TRUE, execute the request recursively if necessary else work as the common mkdir system call \item[{\em GError}]error report system \end{description}
\end{Desc}
\begin{Desc}
\item[Warning:]no check on the path, please check the path before \end{Desc}
\begin{Desc}
\item[Returns:]return 0 if success else return -1 \end{Desc}
\index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_catalog_opendirG@{gfal\_\-catalog\_\-opendirG}}
\index{gfal_catalog_opendirG@{gfal\_\-catalog\_\-opendirG}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}gfal\_\-file\_\-handle gfal\_\-catalog\_\-opendir\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em name}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__catalog_8h_eb89b1d37a16ef8ecb50ac603366285c}


Execute a opendir function on the first compatible catalog ( checked with check url func ) \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em handle}]handle of the current context \item[{\em path}]path to open \item[{\em GError}]error report system \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]gfal\_\-file\_\-handle pointer given to the handle or NULL if error \end{Desc}
\index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_catalog_openG@{gfal\_\-catalog\_\-openG}}
\index{gfal_catalog_openG@{gfal\_\-catalog\_\-openG}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}gfal\_\-file\_\-handle gfal\_\-catalog\_\-open\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, int {\em flag}, mode\_\-t {\em mode}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__catalog_8h_cd4cabbd5effdf20bc0b20345c5cc4ab}


open the file specified by path on the proper catalog with the specified flag and mode \index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_catalog_readdirG@{gfal\_\-catalog\_\-readdirG}}
\index{gfal_catalog_readdirG@{gfal\_\-catalog\_\-readdirG}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}struct dirent$\ast$ gfal\_\-catalog\_\-readdir\-G (gfal\_\-handle {\em handle}, gfal\_\-file\_\-handle {\em fh}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__catalog_8h_9ba0d48d73fe53d42d3a715e57473adb}


execute a readdir for the given file handle on the appropriate catalog \index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_catalog_statG@{gfal\_\-catalog\_\-statG}}
\index{gfal_catalog_statG@{gfal\_\-catalog\_\-statG}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-catalog\_\-stat\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, struct stat $\ast$ {\em st}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__catalog_8h_28ca68c00e4a67bc158975ef3e4f8013}


Execute a stat function on the lfc catalog \index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_catalogs_accessG@{gfal\_\-catalogs\_\-accessG}}
\index{gfal_catalogs_accessG@{gfal\_\-catalogs\_\-accessG}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-catalogs\_\-access\-G (gfal\_\-handle {\em handle}, const char $\ast$ {\em path}, int {\em mode}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__catalog_8h_4fd85b35f2134b73207c12b54e85959d}


Execute an access function on the first catalog compatible in the catalog list return the result of the first valid catalog for a given URL \begin{Desc}
\item[Returns:]result of the access method or -1 if error and set GError with the correct value error : EPROTONOSUPPORT means that the URL is not matched by a catalog \end{Desc}
\index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_catalogs_delete@{gfal\_\-catalogs\_\-delete}}
\index{gfal_catalogs_delete@{gfal\_\-catalogs\_\-delete}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-catalogs\_\-delete (gfal\_\-handle {\em handle}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__catalog_8h_405974336e7b4ebaafeea02577d7d4d5}


Delete all instance of catalogs \index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_catalogs_instance@{gfal\_\-catalogs\_\-instance}}
\index{gfal_catalogs_instance@{gfal\_\-catalogs\_\-instance}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int gfal\_\-catalogs\_\-instance (gfal\_\-handle {\em handle}, GError $\ast$$\ast$ {\em err})}\label{gfal__common__catalog_8h_d272f75eb549a72064524ecce3c25fe7}


Instance all catalogs for use if it's not the case return the number of catalog available \index{gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}!gfal_get_cat_type@{gfal\_\-get\_\-cat\_\-type}}
\index{gfal_get_cat_type@{gfal\_\-get\_\-cat\_\-type}!gfal_common_catalog.h@{gfal\_\-common\_\-catalog.h}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}char$\ast$ gfal\_\-get\_\-cat\_\-type (GError $\ast$$\ast$)}\label{gfal__common__catalog_8h_791ad55a9c8aaca0bb8ae74a3538c202}


catalog type getter 

\begin{Desc}
\item[Returns:]return a string of the type of the catalog return NULL if an error occured and set the GError correctly \end{Desc}
