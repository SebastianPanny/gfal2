##
# simple scons file for build

Import('*')	# import SConstruct exported var
import os

gfal_common_libs = ['ldap', 'vomsc','gfal_srm_ifce','is_ifce'] 		# libraries linked
other_headers=['common/']
common_src = Glob("common/*.c") 
common_voms = Glob("common/voms/*.c")
common_mds = Glob("common/mds/*.c") 
posix_src_all = Glob("posix/*.c")
src_all = common_src + common_mds + common_voms + posix_src_all

plugin_lfc = Glob("common/lfc/*.c")
plugin_srm = Glob("common/srm/*.c")
plugin_rfio = Glob("common/rfio/*.c")


##
# Clone the env for the link flag

env_posix = env.Clone()
env_posix.Append(LIBS=gfal_common_libs)
env_posix.Append(CPPPATH=other_headers)

mainlib = env_posix.SharedLibrary('#build/libs/libgfal', src_all)
staticlib = env_posix.StaticLibrary('#build/libs/libgfal', src_all)

env_plugin = env.Clone();
env_plugin.Append(LIBS=["gfal"])
plugin_lfc_lib = env_plugin.SharedLibrary('#build/libs/libgfal_plugin_lfc', plugin_lfc)
plugin_srm_lib = env_plugin.SharedLibrary('#build/libs/libgfal_plugin_srm', plugin_srm)
plugin_rfio_lib= env_plugin.SharedLibrary('#build/libs/libgfal_plugin_rfio', plugin_rfio);

Default(plugin_rfio_lib,plugin_lfc_lib, plugin_srm_lib, mainlib,staticlib)

